<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Dá»± Ãn MÃ¹a HÃ¨ Xanh</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/screens.css">
    <link rel="stylesheet" href="css/game.css">
    <link rel="stylesheet" href="css/overlays.css">
    <link rel="stylesheet" href="css/panels.css">
    <link rel="stylesheet" href="css/theme.css">
</head>
<body>

<!-- START SCREEN -->
<div id="start-screen">
    <div class="start-logo"><span class="white">Dá»° ÃN</span> MÃ™A HÃˆ XANH</div>
    <p class="start-tagline">"Quáº£n lÃ½ dá»± Ã¡n khÃ´ng chá»‰ lÃ  nhá»¯ng con sá»‘,<br>mÃ  lÃ  nghá»‡ thuáº­t cÃ¢n báº±ng giá»¯a TrÃ¡i Tim vÃ  LÃ½ TrÃ­."</p>
    <div class="start-brief">
        <div class="brief-chip"><span class="chip-icon">ğŸ’°</span> NgÃ¢n sÃ¡ch: 6.000.000Ä‘</div>
        <div class="brief-chip"><span class="chip-icon">â±ï¸</span> Thá»i háº¡n: 25 ngÃ y</div>
        <div class="brief-chip"><span class="chip-icon">ğŸ¯</span> 10 Giai Ä‘oáº¡n</div>
    </div>
    <button class="start-btn" id="start-btn">Báº¯t Äáº§u Tráº£i Nghiá»‡m</button>
</div>

<!-- DIFFICULTY SCREEN -->
<div id="difficulty-screen">
    <p class="diff-heading">Chá»n Äá»™ KhÃ³</p>
    <div class="diff-title">Báº¡n LÃ  Ai Trong HÃ nh TrÃ¬nh NÃ y?</div>
    <div class="diff-cards">
        <div class="diff-card normal" id="diff-normal">
            <span class="diff-card-icon">ğŸŒ±</span>
            <div class="diff-card-name">BÃ¬nh ThÆ°á»ng</div>
            <p class="diff-card-desc">Há»c cÃ¡ch quáº£n lÃ½. Cho phÃ©p sai láº§m vÃ  thá»­ nghiá»‡m.</p>
            <div class="diff-stats">
                <div class="diff-stat-row"><span class="ds-label">ğŸ’° NgÃ¢n sÃ¡ch</span><span class="ds-val">6.000.000Ä‘</span></div>
                <div class="diff-stat-row"><span class="ds-label">â±ï¸ Thá»i háº¡n</span><span class="ds-val">25 ngÃ y</span></div>
                <div class="diff-stat-row"><span class="ds-label">â¤ï¸ Tinh tháº§n</span><span class="ds-val">100%</span></div>
                <div class="diff-stat-row"><span class="ds-label">ğŸ¯ HoÃ n háº£o</span><span class="ds-val">â‰¥ 110 Ä‘iá»ƒm</span></div>
            </div>
        </div>
        <div class="diff-card expert" id="diff-expert">
            <span class="diff-card-icon">âš”ï¸</span>
            <div class="diff-card-name">ChuyÃªn Gia</div>
            <p class="diff-card-desc">Má»—i quyáº¿t Ä‘á»‹nh pháº£i cÃ³ lÃ½ do. KhÃ´ng thá»ƒ an toÃ n mÃ£i.</p>
            <div class="diff-stats">
                <div class="diff-stat-row"><span class="ds-label">ğŸ’° NgÃ¢n sÃ¡ch</span><span class="ds-val">4.500.000Ä‘</span></div>
                <div class="diff-stat-row"><span class="ds-label">â±ï¸ Thá»i háº¡n</span><span class="ds-val">22 ngÃ y</span></div>
                <div class="diff-stat-row"><span class="ds-label">â¤ï¸ Tinh tháº§n</span><span class="ds-val">80%</span></div>
                <div class="diff-stat-row"><span class="ds-label">ğŸ¯ HoÃ n háº£o</span><span class="ds-val">â‰¥ 120 Ä‘iá»ƒm</span></div>
            </div>
        </div>
        <div class="diff-card asian" id="diff-asian">
            <span class="diff-card-icon">ğŸ”¥</span>
            <div class="diff-card-name">Asian Mode</div>
            <p class="diff-card-desc">Báº¡n khÃ´ng thá»­, báº¡n non.</p>
            <div class="diff-stats">
                <div class="diff-stat-row"><span class="ds-label">ğŸ’° NgÃ¢n sÃ¡ch</span><span class="ds-val">3.000.000Ä‘</span></div>
                <div class="diff-stat-row"><span class="ds-label">â±ï¸ Thá»i háº¡n</span><span class="ds-val">19 ngÃ y</span></div>
                <div class="diff-stat-row"><span class="ds-label">â¤ï¸ Tinh tháº§n</span><span class="ds-val">65%</span></div>
                <div class="diff-stat-row"><span class="ds-label">ğŸ¯ HoÃ n háº£o</span><span class="ds-val">â‰¥ 140 Ä‘iá»ƒm</span></div>
            </div>
        </div>
    </div>
    <label class="speed-mode-toggle">
        <input type="checkbox" id="speed-mode-check">
        <span class="speed-mode-label">âš¡ <strong>Speed Mode</strong> â€” Bá»™ Ä‘áº¿m ngÆ°á»£c tá»± chá»n ngáº«u nhiÃªn</span>
    </label>
    <br>
    <button class="diff-back-btn" id="diff-back-btn">â† Quay láº¡i</button>
</div>

<!-- ITEM SCREEN (New Game+) -->
<div id="item-screen">
    <p class="item-heading">â­ New Game+</p>
    <div class="item-title">Chá»n Váº­t Pháº©m Khá»Ÿi Äáº§u</div>
    <p class="item-subtitle">Pháº§n thÆ°á»Ÿng tá»« láº§n chÆ¡i trÆ°á»›c. Chá»n 1 váº­t pháº©m Ä‘á»ƒ mang theo.</p>
    <div class="item-cards">
        <div class="item-card" data-item="budget">
            <span class="item-card-icon">ğŸ’¼</span>
            <div class="item-card-name">TÃºi NgÃ¢n SÃ¡ch Dá»± PhÃ²ng</div>
            <p class="item-card-desc">ThÃªm 1.500.000Ä‘ vÃ o quá»¹ ban Ä‘áº§u. Äá»•i láº¡i Ä‘iá»ƒm cháº¥t lÆ°á»£ng khá»Ÿi Ä‘áº§u tháº¥p hÆ¡n.</p>
            <span class="item-card-stat">+1.500.000Ä‘ / -10 cháº¥t lÆ°á»£ng</span>
        </div>
        <div class="item-card" data-item="captain">
            <span class="item-card-icon">ğŸ–ï¸</span>
            <div class="item-card-name">Huy Hiá»‡u Äá»™i TrÆ°á»Ÿng</div>
            <p class="item-card-desc">Tinh tháº§n nhÃ³m báº¯t Ä‘áº§u cao hÆ¡n 20%. Niá»m tin Ä‘Æ°á»£c tÃ­ch lÅ©y tá»« láº§n trÆ°á»›c.</p>
            <span class="item-card-stat">+20% tinh tháº§n khá»Ÿi Ä‘áº§u</span>
        </div>
        <div class="item-card" data-item="redo">
            <span class="item-card-icon">ğŸ”„</span>
            <div class="item-card-name">Tháº» Redo</div>
            <p class="item-card-desc">Má»™t láº§n duy nháº¥t trong game, Ä‘Æ°á»£c phÃ©p chá»n láº¡i quyáº¿t Ä‘á»‹nh vá»«a Ä‘Æ°a ra.</p>
            <span class="item-card-stat">1 láº§n chá»n láº¡i</span>
        </div>
    </div>
    <button class="item-confirm-btn" id="item-confirm-btn" disabled>âœ… XÃ¡c Nháº­n & Báº¯t Äáº§u</button>
</div>

<!-- GAME CONTAINER -->
<div id="game-container">

    <div class="game-header">
        <button id="log-toggle">ğŸ“‹ Nháº­t KÃ½ <span class="log-count" id="log-count-badge">0</span></button>
        <div class="game-title" id="admin-trigger"><span class="white">Dá»° ÃN:</span> MÃ™A HÃˆ XANH</div>
        <div class="header-right-btns">
            <button id="sound-toggle">ğŸ”Š <span>Ã‚m Thanh</span></button>
            <button id="theme-toggle">ğŸ¨ TÃ¬nh Nguyá»‡n</button>
        </div>
        <div id="stage-dots">
            <div class="s-dot" id="dot-1"></div><div class="s-dot" id="dot-2"></div>
            <div class="s-dot" id="dot-3"></div><div class="s-dot" id="dot-4"></div>
            <div class="s-dot" id="dot-5"></div><div class="s-dot" id="dot-6"></div>
            <div class="s-dot" id="dot-7"></div><div class="s-dot" id="dot-8"></div>
            <div class="s-dot" id="dot-9"></div><div class="s-dot" id="dot-10"></div>
        </div>
        <div id="ai-mode-badge" class="ai-on">âš¡ AI Mode</div>
    </div>

    <div class="status-bar">
        <div class="stat-card" id="money-container">
            <div class="stat-label">TÃ i ChÃ­nh</div>
            <div class="stat-row"><span class="stat-icon">ğŸ’°</span><span class="stat-value" id="money">6.000.000</span><span class="stat-unit">Ä‘</span></div>
            <div class="stat-bar"><div class="stat-bar-fill" id="money-fill" style="width:100%"></div></div>
        </div>
        <div class="stat-card" id="time-container">
            <div class="stat-label">Thá»i Gian</div>
            <div class="stat-row"><span class="stat-icon">â±ï¸</span><span class="stat-value" id="time">25</span><span class="stat-unit">ngÃ y</span></div>
            <div class="stat-bar"><div class="stat-bar-fill" id="time-fill" style="width:100%"></div></div>
        </div>
        <div class="stat-card" id="morale-container">
            <div class="stat-label">Tinh Tháº§n</div>
            <div class="stat-row"><span class="stat-icon">â¤ï¸</span><span class="stat-value" id="morale">100</span><span class="stat-unit">%</span></div>
            <div class="stat-bar"><div class="stat-bar-fill" id="morale-fill" style="width:100%"></div></div>
        </div>
    </div>

    <div id="member-morale-bar">
        <div class="member-chip" id="member-tung">
            <span class="member-avatar">ğŸ˜¤</span>
            <div class="member-info"><div class="member-name">TÃ¹ng</div><div class="member-bar"><div class="member-bar-fill" id="mbar-tung" style="width:100%;background:var(--success)"></div></div></div>
        </div>
        <div class="member-chip" id="member-mai">
            <span class="member-avatar">ğŸŒ¸</span>
            <div class="member-info"><div class="member-name">Mai</div><div class="member-bar"><div class="member-bar-fill" id="mbar-mai" style="width:100%;background:var(--success)"></div></div></div>
        </div>
        <div class="member-chip" id="member-khoa">
            <span class="member-avatar">ğŸ¤”</span>
            <div class="member-info"><div class="member-name">Khoa</div><div class="member-bar"><div class="member-bar-fill" id="mbar-khoa" style="width:100%;background:var(--success)"></div></div></div>
        </div>
        <div class="member-chip" id="member-linh">
            <span class="member-avatar">ğŸ’™</span>
            <div class="member-info"><div class="member-name">Linh</div><div class="member-bar"><div class="member-bar-fill" id="mbar-linh" style="width:100%;background:var(--success)"></div></div></div>
        </div>
    </div>

    <div id="image-container"><img id="scene-image" src="" alt="Scene"></div>

    <div id="oracle-hint" style="display:none">
        <span class="oracle-icon">ğŸ”®</span><span id="oracle-text"></span>
    </div>

    <div id="story-text"></div>

    <div id="speed-countdown" style="display:none">âš¡ Sáºµn sÃ ngâ€¦</div>
    <div class="speed-timer-bar" id="speed-timer-bar" style="display:none">
        <div class="speed-timer-fill" id="speed-timer-fill"></div>
    </div>

    <div class="btn-container" id="choices"></div>

    <!-- Loading Overlay -->
    <div id="loading-overlay">
        <div class="spinner"></div>
        <div id="loading-text">Há»† THá»NG ÄANG PHÃ‚N TÃCH...</div>
        <p class="loading-sub">"SÃ³ng giÃ³ cÃ³ thá»ƒ áº­p Ä‘áº¿n á»Ÿ báº¥t cá»© giai Ä‘oáº¡n nÃ o."</p>
    </div>

    <!-- Event Overlay -->
    <div id="event-overlay">
        <div class="event-icon-big" id="event-icon">ğŸš¨</div>
        <h2 id="event-title">BIáº¾N Cá»!</h2>
        <p id="event-desc"></p>
        <div class="win-rate-badge" id="win-rate-label" style="display:none"></div>
        <div id="gamble-result"><span class="gr-icon" id="gr-icon"></span><span class="gr-text" id="gr-text"></span></div>
        <div class="gamble-btns" id="event-buttons"></div>
    </div>

    <!-- Bonus Overlay -->
    <div id="bonus-overlay">
        <div class="bonus-icon-big" id="bonus-icon">ğŸ</div>
        <div id="bonus-title">CÆ  Há»˜I!</div>
        <p id="bonus-desc"></p>
        <div class="bonus-cost-label" id="bonus-cost-label"></div>
        <div class="bonus-btns" id="bonus-btns"></div>
    </div>

    <!-- Halftime Overlay -->
    <div id="halftime-overlay">
        <div class="halftime-label">âœ¦ CHECKPOINT âœ¦</div>
        <h2>Ná»­a Cháº·ng ÄÆ°á»ng</h2>
        <p class="halftime-subtitle">"KhÃ³ khÄƒn tháº­t sá»± báº¯t Ä‘áº§u tá»« Ä‘Ã¢y. Kiá»ƒm tra láº¡i lá»±c lÆ°á»£ng trÆ°á»›c khi tiáº¿p tá»¥c."</p>
        <div class="halftime-stats">
            <div class="ht-stat-box"><div class="hs-icon">ğŸ’°</div><div class="hs-label">TÃ i chÃ­nh cÃ²n</div><div class="hs-value" id="ht-money"></div></div>
            <div class="ht-stat-box"><div class="hs-icon">â±ï¸</div><div class="hs-label">Thá»i gian cÃ²n</div><div class="hs-value" id="ht-time"></div></div>
            <div class="ht-stat-box"><div class="hs-icon">â¤ï¸</div><div class="hs-label">Tinh tháº§n</div><div class="hs-value" id="ht-morale"></div></div>
            <div class="ht-stat-box"><div class="hs-icon">â­</div><div class="hs-label">Cháº¥t lÆ°á»£ng</div><div class="hs-value" id="ht-quality"></div></div>
        </div>
        <p class="halftime-quote" id="ht-quote"></p>
        <button id="halftime-continue">âš”ï¸ Tiáº¿p Tá»¥c HÃ nh TrÃ¬nh</button>
    </div>

    <!-- Admin Login -->
    <div id="admin-login-overlay">
        <div class="admin-box">
            <h3>ğŸ” Quyá»n Truy Cáº­p GiÃ¡m Äá»‘c</h3>
            <input type="password" id="admin-key-input" placeholder="Nháº­p mÃ£ bÃ­ máº­t...">
            <div class="admin-btn-row">
                <button class="admin-btn danger" id="admin-cancel-btn">Há»§y</button>
                <button class="admin-btn" id="admin-confirm-btn">XÃ¡c nháº­n</button>
            </div>
        </div>
    </div>

    <!-- Admin Panel -->
    <div id="admin-panel-overlay">
        <div class="admin-box">
            <h3>âš™ï¸ God Mode Panel</h3>
            <div class="admin-group"><label>ğŸ’° TÃ i chÃ­nh:</label><input type="number" id="admin-money"></div>
            <div class="admin-group"><label>â±ï¸ Thá»i gian:</label><input type="number" id="admin-time"></div>
            <div class="admin-group"><label>â¤ï¸ Tinh tháº§n:</label><input type="number" id="admin-morale"></div>
            <div class="admin-group"><label>â­ Cháº¥t lÆ°á»£ng:</label><input type="number" id="admin-quality"></div>
            <div class="admin-group"><label>ğŸ¤– Báº­t/Táº¯t AI:</label><input type="checkbox" id="admin-ai-toggle" style="width:20px;height:20px;"></div>
            <div class="admin-group">
                <label>ğŸ² Sá»± CÆ°á»£c AI:</label>
                <div style="display:flex;align-items:center;gap:4px;width:58%;">
                    <input type="number" id="admin-rate-ai" min="0" max="100" step="5" style="width:100%;text-align:right;">
                    <span style="color:var(--text-dim);font-size:0.8rem;flex-shrink:0;">%</span>
                </div>
            </div>
            <div class="admin-group">
                <label>âš¡ Sá»± Cá»‘/May:</label>
                <div style="display:flex;align-items:center;gap:4px;width:58%;">
                    <input type="number" id="admin-rate-static" min="0" max="100" step="5" style="width:100%;text-align:right;">
                    <span style="color:var(--text-dim);font-size:0.8rem;flex-shrink:0;">%</span>
                </div>
            </div>
            <p style="font-size:0.75rem;color:var(--text-dim);margin-bottom:10px;font-style:italic;">ğŸ° Tá»‰ lá»‡ tháº¯ng cÆ°á»£c: tá»± Ä‘á»™ng theo Ä‘á»™ khÃ³</p>
            <button class="admin-btn action" id="admin-force-event-btn">âš¡ Ã‰p Sá»± Kiá»‡n (100%)</button>
            <div class="admin-group" style="margin-top:14px;flex-direction:column;align-items:flex-start;">
                <label style="margin-bottom:8px;">ğŸš€ Nháº£y CÃ³c:</label>
                <div style="display:flex;width:100%;gap:10px;">
                    <select id="admin-stage-select" style="flex:1;text-align:left;">
                        <option value="stage_2">GÄ 2</option>
                        <option value="stage_4">GÄ 4</option>
                        <option value="stage_7">GÄ 7</option>
                        <option value="stage_10">GÄ 10</option>
                        <option value="calc_ending">Tá»•ng káº¿t</option>
                    </select>
                    <button class="admin-btn danger" style="padding:8px 16px;width:auto;" id="admin-jump-btn">GO</button>
                </div>
            </div>
            <div class="admin-btn-row" style="margin-top:16px;">
                <button class="admin-btn danger" id="admin-close-btn">ÄÃ³ng</button>
                <button class="admin-btn" id="admin-save-btn">LÆ°u</button>
            </div>
        </div>
    </div>

</div><!-- end #game-container -->

<!-- Decision Log Panel -->
<div id="log-panel-backdrop"></div>
<div id="decision-log-panel">
    <div class="lp-header">
        <div class="lp-header-title">ğŸ“‹ Nháº­t KÃ½ Quyáº¿t Äá»‹nh</div>
        <button id="log-close-btn">âœ•</button>
    </div>
    <div id="log-entries"></div>
</div>

<!-- Character Bubble -->
<div id="char-bubble">
    <div class="cb-avatar" id="cb-avatar">ğŸ˜¤</div>
    <div><div class="cb-name" id="cb-name">TÃ¹ng</div><div class="cb-text" id="cb-text"></div></div>
</div>

<!-- END SCREEN -->
<div id="end-screen">
    <div class="end-badge-wrap" id="end-badge"></div>
    <h2 id="end-title"></h2>
    <div id="end-track-label" style="display:none"></div>
    <p class="end-subtitle" id="end-subtitle"></p>

    <div id="end-image-container" style="display:none">
        <img id="end-image" src="" alt="Ending Scene">
    </div>

    <div id="leadership-profile-card" style="display:none">
        <div class="lp-card-label">ğŸ¯ PHONG CÃCH LÃƒNH Äáº O Cá»¦A Báº N</div>
        <div id="lp-card-body">
            <div class="lp-loading"><div class="lp-spinner"></div> AI Ä‘ang phÃ¢n tÃ­ch phong cÃ¡ch lÃ£nh Ä‘áº¡oâ€¦</div>
        </div>
    </div>

    <div id="memory-album" style="display:none">
        <h3>ğŸ“¸ KÃ½ á»¨c HÃ nh TrÃ¬nh</h3>
        <div class="album-strip" id="album-strip"></div>
    </div>

    <div id="end-trust-summary" style="display:none"></div>

    <div class="end-stats-grid">
        <div class="end-stat-card"><div class="esk-label">ğŸ’° TÃ i chÃ­nh cÃ²n</div><div class="esk-value" id="end-money"></div></div>
        <div class="end-stat-card"><div class="esk-label">â±ï¸ NgÃ y dÆ°</div><div class="esk-value" id="end-time"></div></div>
        <div class="end-stat-card"><div class="esk-label">â¤ï¸ Tinh tháº§n</div><div class="esk-value" id="end-morale"></div></div>
        <div class="end-stat-card"><div class="esk-label">â­ Cháº¥t lÆ°á»£ng</div><div class="esk-value" id="end-quality"></div></div>
        <div class="end-stat-card"><div class="esk-label">ğŸ² Biáº¿n cá»‘ gáº·p</div><div class="esk-value" id="end-events"></div></div>
    </div>

    <div id="judge-panel" style="display:none">
        <h3>âš–ï¸ Há»™i Äá»“ng PhÃ¡n XÃ©t</h3>
        <div class="judge-cards" id="judge-cards">
            <div class="judge-loading"><div class="lp-spinner"></div> AI Ä‘ang tá»•ng há»£p nháº­n xÃ©tâ€¦</div>
        </div>
    </div>

    <div id="leaderboard-section" style="display:none">
        <h3>ğŸ† Báº£ng Xáº¿p Háº¡ng CÃ¡ NhÃ¢n</h3>
        <div id="lb-body"></div>
    </div>

    <p class="secret-hint" id="secret-hint" style="display:none">
        "ÄÃ¢y lÃ  true ending â€” liá»‡u báº¡n cÃ³ thá»ƒ thÃ nh cÃ´ng láº¥y Ä‘Æ°á»£c Secret Ending, má»™t áº£nh ending khÃ´ng nÃªn tá»“n táº¡i?"
    </p>

    <button id="ng-plus-btn" style="display:none">â­ New Game+ â€” Mang Pháº§n ThÆ°á»Ÿng Sang Láº§n Sau</button>
    <button class="replay-btn" id="replay-btn">ğŸ”„ ChÆ¡i Láº¡i</button>
</div>

<script type="module" src="js/main.js"></script>
</body>
</html>
