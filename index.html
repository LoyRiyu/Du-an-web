<!DOCTYPE html>
<html lang="vi" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>An Giang M·ªπ V·ªã - B·∫£n ƒë·ªì ·∫©m th·ª±c</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Google Fonts: Be Vietnam Pro -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap&subset=vietnamese" rel="stylesheet">
    
    <!-- Markdown Parser -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <!-- AOS Animation Library -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

    <style>
        /* GLOBAL FONT CONFIGURATION */
        :root { --font-main: 'Be Vietnam Pro', sans-serif; }
        body { font-family: var(--font-main); overflow-x: hidden; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; text-rendering: optimizeLegibility; font-synthesis: none; }
        h1, h2, h3, h4, .font-serif { font-family: var(--font-main) !important; letter-spacing: -0.02em; }
        
        /* UI Utilities */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #f5f5f4; }
        ::-webkit-scrollbar-thumb { background: #d6d3d1; border-radius: 4px; }
        .glass { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px); border-bottom: 1px solid rgba(0,0,0,0.05); }
        .img-zoom-container { overflow: hidden; }
        .img-zoom-container img { transition: transform 0.7s cubic-bezier(0.25, 0.46, 0.45, 0.94); }
        .img-zoom-container:hover img { transform: scale(1.1); }
        
        /* Animations */
        @keyframes float { 0%, 100% { transform: translateY(0px) rotate(1deg); } 50% { transform: translateY(-10px) rotate(-1deg); } }
        .animate-float { animation: float 6s ease-in-out infinite; }
        @keyframes pulse-ring { 0% { transform: scale(0.8); box-shadow: 0 0 0 0 rgba(180, 83, 9, 0.7); } 70% { transform: scale(1); box-shadow: 0 0 0 15px rgba(180, 83, 9, 0); } 100% { transform: scale(0.8); box-shadow: 0 0 0 0 rgba(180, 83, 9, 0); } }
        .animate-pulse-ring { animation: pulse-ring 2s infinite; }
        .typing-dot { animation: typing 1.4s infinite ease-in-out both; }
        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }
        @keyframes typing { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1); } }
        @keyframes modalPop { 0% { opacity: 0; transform: scale(0.95) translateY(10px); } 100% { opacity: 1; transform: scale(1) translateY(0); } }
        .modal-animate { animation: modalPop 0.3s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        @keyframes fade-in-up { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade-in-up { animation: fade-in-up 0.3s ease-out forwards; }
        @keyframes fade-down { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade-down { animation: fade-down 0.3s ease-out forwards; }
    </style>
</head>
<body class="bg-[#FDFBF7] text-stone-800 antialiased selection:bg-amber-200 selection:text-amber-900">

    <!-- HEADER -->
    <header class="sticky top-0 z-50 glass transition-all duration-300">
        <div class="container mx-auto px-4 h-16 flex items-center justify-between">
            <button class="md:hidden text-stone-600 hover:text-amber-700 p-2" onclick="toggleMobileMenu()"><i data-lucide="menu" class="w-6 h-6"></i></button>
            <div class="flex items-center gap-2 cursor-pointer group" onclick="window.scrollTo({top: 0, behavior: 'smooth'})">
                <span class="text-xl md:text-2xl font-serif font-black text-amber-700 tracking-tighter group-hover:scale-105 transition-transform duration-300">AnGiang<span class="text-stone-800">M·ªπV·ªã</span></span>
            </div>
            <nav class="hidden md:flex gap-8 font-semibold text-stone-600 text-sm tracking-wide">
                <button onclick="scrollToSection('section-reviews')" class="hover:text-amber-700 transition-colors hover:-translate-y-0.5 transform duration-200">VI VU</button>
                <button onclick="scrollToSection('section-mood')" class="hover:text-amber-700 transition-colors hover:-translate-y-0.5 transform duration-200">M√ìN NGON</button>
                <button onclick="scrollToSection('section-community')" class="hover:text-amber-700 transition-colors hover:-translate-y-0.5 transform duration-200 text-amber-600">C·ªòNG ƒê·ªíNG</button>
                <button onclick="openModal('foodtour')" class="hover:text-amber-700 transition-colors hover:-translate-y-0.5 transform duration-200">FOOD TOUR</button>
            </nav>
            <div class="flex items-center gap-2 md:gap-4">
                <button class="p-2 hover:bg-stone-100 rounded-full transition-colors active:scale-90 duration-150"><i data-lucide="search" class="w-5 h-5 text-stone-600"></i></button>
                <button onclick="openModal('add-dish')" class="hidden md:block bg-stone-900 text-white px-6 py-2.5 rounded-full text-sm font-bold hover:shadow-xl hover:-translate-y-0.5 transition-all active:scale-95 duration-200">L∆∞u m√≥n</button>
            </div>
        </div>
        <div id="mobile-menu" class="hidden md:hidden bg-white/95 backdrop-blur-xl border-b border-stone-200 p-4 space-y-2 shadow-lg absolute w-full top-16 left-0 z-40 animate-fade-down">
            <button onclick="scrollToSection('section-reviews'); toggleMobileMenu()" class="block font-bold w-full text-left py-3 px-4 hover:bg-amber-50 rounded-xl transition-colors text-stone-700">VI VU</button>
            <button onclick="scrollToSection('section-mood'); toggleMobileMenu()" class="block font-bold w-full text-left py-3 px-4 hover:bg-amber-50 rounded-xl transition-colors text-stone-700">M√ìN NGON</button>
            <button onclick="scrollToSection('section-community'); toggleMobileMenu()" class="block font-bold w-full text-left py-3 px-4 hover:bg-amber-50 rounded-xl transition-colors text-amber-700">C·ªòNG ƒê·ªíNG</button>
            <button onclick="openModal('foodtour'); toggleMobileMenu()" class="block font-bold w-full text-left py-3 px-4 hover:bg-amber-50 rounded-xl transition-colors text-stone-700">FOOD TOUR</button>
            <button onclick="openModal('add-dish'); toggleMobileMenu()" class="block font-bold w-full text-center py-3 mt-2 bg-stone-900 text-white rounded-xl">ƒêƒÉng m√≥n ngay</button>
        </div>
    </header>

    <!-- CONTENT SECTIONS -->
    <section class="relative pt-8 md:pt-12 pb-16 md:pb-24 overflow-hidden">
        <div class="absolute top-0 right-0 w-64 md:w-96 h-64 md:h-96 bg-amber-200 rounded-full blur-[80px] md:blur-[100px] opacity-40 -translate-y-1/2 translate-x-1/2 animate-pulse"></div>
        <div class="absolute bottom-0 left-0 w-[300px] md:w-[500px] h-[300px] md:h-[500px] bg-green-100 rounded-full blur-[80px] md:blur-[120px] opacity-50 translate-y-1/2 -translate-x-1/4 animate-pulse" style="animation-duration: 4s;"></div>
        <div class="container mx-auto px-4 grid grid-cols-1 md:grid-cols-2 gap-8 md:gap-12 items-center relative z-10">
            <div class="space-y-6 md:space-y-8 order-1 md:order-1 text-center md:text-left" data-aos="fade-right" data-aos-duration="1000">
                <div class="inline-flex items-center gap-2 bg-white/80 backdrop-blur border border-stone-200 text-stone-800 px-4 py-2 rounded-full text-[10px] md:text-xs font-bold uppercase tracking-wider shadow-sm hover:shadow-md transition-shadow cursor-default"><span class="w-2 h-2 bg-green-500 rounded-full animate-ping"></span><span class="relative">M√πa n∆∞·ªõc n·ªïi - M√πa c√° linh</span></div>
                <h1 class="text-4xl md:text-7xl font-serif font-black leading-[1.1] text-stone-900 tracking-tight">V·ªÅ An Giang, <br/><span class="text-amber-600 italic">ƒÉn m·ªôt l·∫ßn</span> <br/>nh·ªõ m·ªôt ƒë·ªùi.</h1>
                <p class="text-base md:text-lg text-stone-600 max-w-md mx-auto md:mx-0 leading-relaxed font-medium">Kh√°m ph√° b·∫£n ƒë·ªì ·∫©m th·ª±c giao thoa gi·ªØa 4 n·ªÅn vƒÉn h√≥a Kinh - Hoa - ChƒÉm - Khmer ƒë·ªôc ƒë√°o nh·∫•t mi·ªÅn T√¢y.</p>
                <div class="flex gap-3 md:gap-4 pt-2 justify-center md:justify-start">
                    <button onclick="scrollToSection('section-reviews')" class="bg-stone-900 text-white px-6 md:px-8 py-3 md:py-4 rounded-full font-bold hover:bg-stone-800 transition-all flex items-center gap-2 group hover:shadow-xl hover:-translate-y-1 duration-300 text-sm md:text-base">Kh√°m ph√° <i data-lucide="arrow-right" class="w-4 h-4 md:w-5 md:h-5 group-hover:translate-x-1 transition-transform"></i></button>
                    <button onclick="openModal('foodtour')" class="px-6 md:px-8 py-3 md:py-4 rounded-full font-bold border-2 border-stone-200 hover:border-stone-900 hover:bg-white transition-all hover:shadow-lg hover:-translate-y-1 duration-300 bg-white/50 backdrop-blur text-sm md:text-base">Xem b·∫£n ƒë·ªì</button>
                </div>
            </div>
            <div class="relative cursor-pointer group animate-float order-2 md:order-2" onclick="openProductDetail(1)" data-aos="fade-left" data-aos-duration="1200" data-aos-delay="200">
                <div class="relative z-20 transform rotate-2 group-hover:rotate-0 transition-transform duration-700 ease-out mx-auto max-w-md md:max-w-full">
                    <div class="bg-white p-3 md:p-4 shadow-2xl rounded-2xl">
                        <div class="overflow-hidden rounded-xl h-[300px] md:h-[450px]"><img src="https://mia.vn/media/uploads/blog-du-lich/bun-ca-chau-doc-dac-san-tru-danh-cua-dat-an-giang-01-1659942632.jpg" alt="B√∫n c√° Ch√¢u ƒê·ªëc" class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-[1.5s]"></div>
                        <div class="pt-4 pb-1 text-center font-bold text-stone-800 text-sm md:text-base">B·ªØa s√°ng t·∫°i Ch√¢u ƒê·ªëc, 2024</div>
                        <div class="text-center text-[10px] md:text-xs text-stone-500 font-medium uppercase tracking-widest">An Giang Authentic</div>
                    </div>
                </div>
                <div class="absolute -top-4 -right-2 md:-top-6 md:-right-6 z-30 bg-amber-400 p-1 rounded-full shadow-xl transform rotate-12 group-hover:rotate-[20deg] transition-transform duration-500"><div class="border-2 border-dashed border-white rounded-full w-16 h-16 md:w-24 md:h-24 flex items-center justify-center text-center text-[10px] md:text-xs font-black text-white uppercase leading-tight">Must<br/>Try</div></div>
            </div>
        </div>
    </section>

    <section class="py-16 md:py-24 bg-white border-y border-stone-100 relative">
        <div class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-5"></div>
        <div class="container mx-auto px-4 relative z-10">
            <div class="text-center mb-12 md:mb-16" data-aos="fade-up"><h2 class="text-2xl md:text-4xl font-serif font-black text-stone-900 mb-3 tracking-tight">Giao thoa 4 n·ªÅn vƒÉn h√≥a</h2><div class="w-16 h-1.5 bg-amber-500 mx-auto rounded-full"></div></div>
            <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-6">
                <div onclick="scrollToSection('section-reviews')" class="group relative p-6 md:p-8 rounded-[2rem] border border-stone-100 bg-stone-50/50 hover:bg-white hover:shadow-xl hover:-translate-y-2 transition-all duration-500 cursor-pointer overflow-hidden" data-aos="fade-up"><div class="absolute top-0 right-0 w-24 md:w-32 h-24 md:h-32 rounded-bl-full opacity-10 bg-blue-600 transition-transform group-hover:scale-[2.5] duration-700 ease-in-out"></div><h3 class="text-xl md:text-2xl font-serif font-extrabold mb-2 relative z-10 group-hover:text-blue-700 transition-colors">V·ªã Kinh</h3><div class="h-1 w-8 bg-blue-200 mb-4 rounded-full group-hover:w-16 transition-all duration-500"></div><p class="text-[10px] md:text-xs font-bold uppercase tracking-wider mb-2 text-blue-800/80 relative z-10">ƒê·∫≠m ƒë√† s√¥ng n∆∞·ªõc</p><p class="text-stone-600 text-sm leading-relaxed relative z-10 font-medium">L·∫©u m·∫Øm, B√∫n c√°, Canh chua.</p></div>
                <div onclick="scrollToSection('section-reviews')" class="group relative p-6 md:p-8 rounded-[2rem] border border-stone-100 bg-stone-50/50 hover:bg-white hover:shadow-xl hover:-translate-y-2 transition-all duration-500 cursor-pointer overflow-hidden" data-aos="fade-up" data-aos-delay="100"><div class="absolute top-0 right-0 w-24 md:w-32 h-24 md:h-32 rounded-bl-full opacity-10 bg-red-600 transition-transform group-hover:scale-[2.5] duration-700 ease-in-out"></div><h3 class="text-xl md:text-2xl font-serif font-extrabold mb-2 relative z-10 group-hover:text-red-700 transition-colors">V·ªã Hoa</h3><div class="h-1 w-8 bg-red-200 mb-4 rounded-full group-hover:w-16 transition-all duration-500"></div><p class="text-[10px] md:text-xs font-bold uppercase tracking-wider mb-2 text-red-800/80 relative z-10">Gia truy·ªÅn tinh t·∫ø</p><p class="text-stone-600 text-sm leading-relaxed relative z-10 font-medium">C∆°m t·∫•m Long Xuy√™n, H·ªß ti·∫øu h·ªì.</p></div>
                <div onclick="scrollToSection('section-reviews')" class="group relative p-6 md:p-8 rounded-[2rem] border border-stone-100 bg-stone-50/50 hover:bg-white hover:shadow-xl hover:-translate-y-2 transition-all duration-500 cursor-pointer overflow-hidden" data-aos="fade-up" data-aos-delay="200"><div class="absolute top-0 right-0 w-24 md:w-32 h-24 md:h-32 rounded-bl-full opacity-10 bg-purple-600 transition-transform group-hover:scale-[2.5] duration-700 ease-in-out"></div><h3 class="text-xl md:text-2xl font-serif font-extrabold mb-2 relative z-10 group-hover:text-purple-700 transition-colors">V·ªã ChƒÉm</h3><div class="h-1 w-8 bg-purple-200 mb-4 rounded-full group-hover:w-16 transition-all duration-500"></div><p class="text-[10px] md:text-xs font-bold uppercase tracking-wider mb-2 text-purple-800/80 relative z-10">H∆∞∆°ng v·ªã huy·ªÅn b√≠</p><p class="text-stone-600 text-sm leading-relaxed relative z-10 font-medium">C√† ri b√≤, Tung l√≤ m√≤.</p></div>
                <div onclick="scrollToSection('section-reviews')" class="group relative p-6 md:p-8 rounded-[2rem] border border-stone-100 bg-stone-50/50 hover:bg-white hover:shadow-xl hover:-translate-y-2 transition-all duration-500 cursor-pointer overflow-hidden" data-aos="fade-up" data-aos-delay="300"><div class="absolute top-0 right-0 w-24 md:w-32 h-24 md:h-32 rounded-bl-full opacity-10 bg-green-600 transition-transform group-hover:scale-[2.5] duration-700 ease-in-out"></div><h3 class="text-xl md:text-2xl font-serif font-extrabold mb-2 relative z-10 group-hover:text-green-700 transition-colors">V·ªã Khmer</h3><div class="h-1 w-8 bg-green-200 mb-4 rounded-full group-hover:w-16 transition-all duration-500"></div><p class="text-[10px] md:text-xs font-bold uppercase tracking-wider mb-2 text-green-800/80 relative z-10">M·ªôc m·∫°c n√∫i r·ª´ng</p><p class="text-stone-600 text-sm leading-relaxed relative z-10 font-medium">G√† ƒë·ªët l√° ch√∫c, B√∫n n∆∞·ªõc l√®o.</p></div>
            </div>
        </div>
    </section>

    <section id="section-mood" class="py-16 md:py-20 container mx-auto px-4">
        <div class="bg-[#1c1917] rounded-[2rem] md:rounded-[3rem] p-8 md:p-20 text-center text-white relative overflow-hidden shadow-2xl" data-aos="zoom-in">
            <div class="absolute inset-0 opacity-20" style="background-image: radial-gradient(circle, #44403c 1px, transparent 1px); background-size: 30px 30px;"></div>
            <h2 class="text-2xl md:text-5xl font-serif mb-8 md:mb-12 relative z-10 font-black tracking-tight">H√¥m nay b·ª•ng b·∫£o sao?</h2>
            <div class="flex flex-wrap justify-center gap-3 md:gap-4 relative z-10" id="filter-buttons"></div>
        </div>
    </section>

    <section id="section-reviews" class="pb-16 md:pb-24 container mx-auto px-4">
        <div class="flex flex-col md:flex-row justify-between items-start md:items-end mb-8 md:mb-12 gap-4" data-aos="fade-up">
            <div>
                <h2 class="text-3xl md:text-4xl font-serif font-black text-stone-900 tracking-tight">Th·ªï ƒë·ªãa m√°ch n∆∞·ªõc</h2>
                <p class="text-stone-500 mt-2 md:mt-3 text-base md:text-lg font-medium">Nh·ªØng qu√°n ngon d√¢n b·∫£n ƒë·ªãa hay gh√©.</p>
            </div>
        </div>
        <div id="product-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 md:gap-8"></div>
    </section>

    <!-- COMMUNITY SECTION -->
    <section id="section-community" class="pb-16 md:pb-24 container mx-auto px-4">
        <div class="flex flex-col md:flex-row justify-between items-start md:items-end mb-8 md:mb-12 gap-4" data-aos="fade-up">
            <div>
                <div class="inline-flex items-center gap-2 text-amber-600 font-bold text-xs uppercase tracking-wider mb-2"><i data-lucide="users" class="w-4 h-4"></i> D√†nh cho b·∫°n</div>
                <h2 class="text-3xl md:text-4xl font-serif font-black text-stone-900 tracking-tight">C·ªông ƒë·ªìng ƒë·ªÅ c·ª≠</h2>
                <p class="text-stone-500 mt-2 md:mt-3 text-base md:text-lg font-medium">M√≥n ngon & B√¨nh lu·∫≠n t·ª´ th·ª±c kh√°ch.</p>
            </div>
            <button onclick="openModal('add-dish')" class="bg-amber-500 text-white px-6 py-3 rounded-full font-bold hover:bg-amber-600 transition-all shadow-lg hover:-translate-y-1 flex items-center gap-2"><i data-lucide="plus" class="w-5 h-5"></i> ƒêƒÉng m√≥n ngay</button>
        </div>
        <div id="community-loading" class="hidden text-center py-12"><div class="w-10 h-10 border-4 border-stone-200 border-t-amber-500 rounded-full animate-spin mx-auto"></div><p class="text-stone-400 mt-4 text-sm font-medium">ƒêang t·∫£i d·ªØ li·ªáu...</p></div>
        <div id="community-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 md:gap-8"></div>
    </section>

    <section id="section-story" class="py-16 md:py-24 bg-[#F5F2EA] relative">
        <div class="absolute top-0 w-full h-24 bg-gradient-to-b from-[#FDFBF7] to-transparent"></div>
        <div class="container mx-auto px-4">
            <div class="grid md:grid-cols-2 gap-10 md:gap-16 items-center">
                <div class="order-2 md:order-1 relative group cursor-pointer" onclick="openModal('story')" data-aos="fade-right">
                    <div class="absolute -top-3 -left-3 md:-top-4 md:-left-4 w-full h-full border-2 border-stone-800 rounded-2xl md:rounded-[2rem] transition-transform group-hover:translate-x-2 group-hover:translate-y-2"></div>
                    <div class="relative z-10 rounded-2xl md:rounded-[2rem] shadow-2xl overflow-hidden aspect-[4/5]"><img src="https://product.hstatic.net/1000384853/product/420_2e96288a92d94a31a4d3fd7be5d8eae2.jpg" alt="Chuy·ªán b√™n b·∫øp l·ª≠a" class="w-full h-full object-cover grayscale hover:grayscale-0 transition-all duration-[1.5s] group-hover:scale-105"></div>
                </div>
                <div class="order-1 md:order-2 space-y-6 md:space-y-10" data-aos="fade-left">
                    <div class="inline-flex items-center gap-3 text-amber-700 font-extrabold text-xs md:text-sm tracking-[0.2em] uppercase border-b-2 border-amber-200 pb-2"><i data-lucide="flame" class="w-4 h-4 md:w-5 md:h-5 animate-pulse text-red-500"></i> Chuy·ªán b√™n b·∫øp l·ª≠a</div>
                    <h2 class="text-3xl md:text-6xl font-serif font-black text-stone-900 leading-[1.1] tracking-tight">G√°nh b√°nh b√≤ <br/><span class="text-stone-400">30 nƒÉm ƒë·ªè l·ª≠a</span> <br/>d∆∞·ªõi ch√¢n n√∫i Sam.</h2>
                    <blockquote class="border-l-4 border-amber-500 pl-6 md:pl-8 py-2 text-lg md:text-2xl font-medium italic text-stone-600">"L√†m b√°nh n√†y kh√¥ng ƒë∆∞·ª£c v·ªôi, b·ªôt ph·∫£i ·ªß ƒë·ªß n·∫Øng v·ªõi c√°i men c∆°m r∆∞·ª£u c≈© m·ªõi ch·ªãu d·∫≠y m√πi."</blockquote>
                    <p class="text-stone-600 leading-relaxed text-base md:text-lg font-medium">N·∫±m khu·∫•t trong con h·∫ªm nh·ªè, l√≤ b√°nh c·ªßa d√¨ √öt v·∫´n ng√†y ng√†y cho ra nh·ªØng m·∫ª b√°nh b√≤ v√†ng ∆∞∆°m, x·ªëp nh·∫π nh∆∞ m√¢y...</p>
                    <button onclick="openModal('story')" class="text-stone-900 font-bold border-b-2 border-stone-900 pb-1 hover:text-amber-700 hover:border-amber-700 transition-all text-base md:text-lg group">ƒê·ªçc tr·ªçn v·∫πn c√¢u chuy·ªán <i data-lucide="arrow-right" class="inline-block w-4 h-4 ml-1 group-hover:translate-x-1 transition-transform"></i></button>
                </div>
            </div>
        </div>
    </section>

    <footer class="bg-[#1c1917] text-stone-400 py-16 md:py-24 relative overflow-hidden">
        <div class="container mx-auto px-4 grid grid-cols-1 md:grid-cols-3 gap-10 md:gap-16 relative z-10">
            <div>
                <span class="text-2xl md:text-3xl font-serif font-black text-white tracking-tighter block mb-6 md:mb-8">AnGiang<span class="text-amber-500">M·ªπV·ªã</span></span>
                <p class="text-sm md:text-base leading-relaxed mb-6 md:mb-8 opacity-80 font-medium">H√†nh tr√¨nh kh√°m ph√° v√† l∆∞u gi·ªØ nh·ªØng h∆∞∆°ng v·ªã m·ªôc m·∫°c, ch√¢n ph∆∞∆°ng nh·∫•t c·ªßa v√πng ƒë·∫•t B·∫£y N√∫i.</p>
            </div>
            <div><h4 class="text-white font-bold mb-6 md:mb-8 text-lg uppercase tracking-wider">Kh√°m ph√°</h4><ul class="space-y-4 md:space-y-5 text-sm font-bold text-stone-500"><li><button onclick="openModal('foodtour')" class="hover:text-amber-500 transition-colors flex items-center gap-3 group"><span class="w-1.5 h-1.5 bg-amber-500 rounded-full opacity-0 group-hover:opacity-100 transition-opacity"></span> B·∫£n ƒë·ªì Food Tour</button></li><li><button onclick="filterByFooter('doi')" class="hover:text-amber-500 transition-colors flex items-center gap-3 group"><span class="w-1.5 h-1.5 bg-amber-500 rounded-full opacity-0 group-hover:opacity-100 transition-opacity"></span> M√≥n ngon ƒÉn s√°ng</button></li></ul></div>
            <div><h4 class="text-white font-bold mb-6 md:mb-8 text-lg uppercase tracking-wider">Nh·∫≠n th∆∞ t·ª´ Mi·ªÅn T√¢y</h4><div class="flex relative group"><input type="email" placeholder="Email..." class="bg-stone-800 border border-stone-700 rounded-full pl-6 pr-32 md:pr-36 py-3 md:py-4 w-full text-white outline-none focus:border-amber-500 transition-colors font-medium"><button class="absolute right-1.5 top-1.5 bg-amber-600 text-white px-6 md:px-8 py-1.5 md:py-2.5 rounded-full font-bold hover:bg-amber-700 transition-colors shadow-lg text-sm md:text-base">G·ª≠i</button></div></div>
        </div>
        <div class="container mx-auto px-4 mt-16 md:mt-20 pt-8 border-t border-stone-800 text-center text-xs opacity-40 font-medium tracking-wide">&copy; 2025 An Giang M·ªπ V·ªã. Thi·∫øt k·∫ø v·ªõi t√¨nh y√™u d√†nh cho Th·∫•t S∆°n.</div>
    </footer>

    <!-- ALL MODALS & WIDGETS -->
    <div id="modal-overlay" class="fixed inset-0 z-[90] bg-stone-900/60 backdrop-blur-md hidden transition-all duration-500" onclick="closeAllModals()"></div>

    <!-- 1. Product Modal -->
    <div id="modal-product" class="fixed inset-0 z-[100] flex items-center justify-center p-4 hidden pointer-events-none"><div class="bg-white/95 backdrop-blur-2xl rounded-2xl md:rounded-[2rem] shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto pointer-events-auto relative modal-animate flex flex-col border border-white/50"><div class="sticky top-0 bg-white/90 backdrop-blur-md px-5 py-4 md:px-8 md:py-5 border-b border-stone-100 flex justify-between items-center z-20"><h3 id="mp-title" class="text-lg md:text-2xl font-serif font-black text-stone-800 line-clamp-1"></h3><button onclick="closeAllModals()" class="p-2 hover:bg-stone-100 rounded-full transition-colors hover:rotate-90 duration-300"><i data-lucide="x"></i></button></div><div class="p-5 md:p-8 space-y-6 md:space-y-8 font-medium"><div class="img-zoom-container rounded-xl md:rounded-2xl shadow-xl overflow-hidden aspect-video"><img id="mp-image" src="" class="w-full h-full object-cover"></div><div id="mp-tags" class="flex gap-2 flex-wrap"></div><div class="grid grid-cols-1 md:grid-cols-3 gap-3 md:gap-4"><div class="bg-stone-50 p-4 rounded-xl border border-stone-100"><div class="flex items-center gap-2 text-amber-700 font-bold mb-1 text-xs uppercase tracking-wider"><i data-lucide="map-pin" class="w-3 h-3"></i> Xu·∫•t X·ª©</div><p id="mp-origin" class="text-sm text-stone-700"></p></div><div class="bg-stone-50 p-4 rounded-xl border border-stone-100"><div class="flex items-center gap-2 text-amber-700 font-bold mb-1 text-xs uppercase tracking-wider"><i data-lucide="utensils" class="w-3 h-3"></i> H∆∞∆°ng V·ªã</div><p id="mp-taste" class="text-sm text-stone-700"></p></div><div class="bg-stone-50 p-4 rounded-xl border border-stone-100"><div class="flex items-center gap-2 text-amber-700 font-bold mb-1 text-xs uppercase tracking-wider"><i data-lucide="history" class="w-3 h-3"></i> Ngu·ªìn G·ªëc</div><p id="mp-history" class="text-sm text-stone-700"></p></div></div><div class="bg-amber-50/50 p-5 md:p-6 rounded-2xl flex flex-col md:flex-row justify-between items-center gap-4 md:gap-6 border border-amber-100"><div class="text-center md:text-left w-full md:w-auto"><h4 class="font-bold mb-1 text-amber-900 uppercase text-xs tracking-wider">Th√¥ng tin qu√°n:</h4><p class="text-sm md:text-base font-bold text-stone-800 break-words">üìç <span id="mp-address"></span></p><p class="text-sm md:text-base text-amber-600 font-bold">üí∞ <span id="mp-price"></span></p></div><button id="btn-directions" class="bg-stone-900 text-white px-6 md:px-8 py-3 md:py-3.5 rounded-full font-bold flex items-center justify-center gap-3 hover:bg-stone-800 transition-all shadow-lg hover:shadow-xl hover:-translate-y-1 w-full md:w-auto text-sm md:text-base"><i data-lucide="navigation" class="w-4 h-4 md:w-5 md:h-5"></i> Ch·ªâ ƒë∆∞·ªùng ngay</button></div><div class="prose prose-stone max-w-none prose-p:text-stone-600 prose-headings:font-serif"><h4 class="font-serif font-bold text-lg md:text-xl mb-3 border-b border-stone-100 pb-2">C√¢u chuy·ªán m√≥n ƒÉn</h4><p id="mp-desc-long" class="italic leading-relaxed text-base md:text-lg"></p></div></div></div></div>
    <!-- 2. Map Modal -->
    <div id="modal-map" class="fixed inset-0 z-[100] flex items-center justify-center p-4 hidden pointer-events-none"><div class="bg-white/95 backdrop-blur-xl rounded-2xl md:rounded-[2rem] shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto pointer-events-auto relative modal-animate flex flex-col"><div class="sticky top-0 bg-white/80 backdrop-blur px-5 py-4 md:px-8 md:py-5 border-b border-stone-200 flex justify-between items-center z-20"><h3 id="map-title" class="text-lg md:text-xl font-serif font-black text-stone-800 line-clamp-1"></h3><button onclick="closeAllModals()" class="p-2 hover:bg-stone-100 rounded-full transition-colors"><i data-lucide="x"></i></button></div><div class="p-5 md:p-8 space-y-4 md:space-y-6 font-medium"><div class="bg-blue-50 border border-blue-100 p-4 md:p-5 rounded-2xl flex items-start gap-3 md:gap-4 animate-pulse"><div class="bg-blue-100 p-2 md:p-2.5 rounded-full text-blue-600 mt-1"><i data-lucide="navigation" class="w-5 h-5 md:w-6 md:h-6"></i></div><div><h4 class="font-bold text-blue-900 text-base md:text-lg">Th√¥ng tin l·ªô tr√¨nh</h4><div id="map-status" class="text-xs md:text-sm text-blue-800 mt-1 space-y-1">ƒêang ch·ªù t√≠n hi·ªáu v·ªá tinh...</div></div></div><div class="relative w-full h-64 md:h-80 rounded-2xl overflow-hidden shadow-inner border border-stone-200 bg-stone-100"><iframe id="map-iframe" width="100%" height="100%" frameborder="0" scrolling="no" class="filter contrast-[0.9] saturate-[0.8]" src=""></iframe></div><div class="grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4 pt-2"><a id="btn-google-maps" href="#" target="_blank" class="bg-green-600 text-white px-6 py-3 md:py-4 rounded-xl font-bold flex items-center justify-center gap-3 hover:bg-green-700 transition-all shadow-md hover:-translate-y-1 text-sm md:text-base"><i data-lucide="navigation" class="w-4 h-4 md:w-5 md:h-5"></i> M·ªü Google Maps</a><button onclick="closeAllModals()" class="bg-stone-200 text-stone-700 px-6 py-3 md:py-4 rounded-xl font-bold hover:bg-stone-300 transition-all text-sm md:text-base">ƒê√≥ng</button></div></div></div></div>
    <!-- 3. FoodTour Modal -->
    <div id="modal-foodtour" class="fixed inset-0 z-[100] flex items-center justify-center p-4 hidden pointer-events-none"><div class="bg-white rounded-2xl md:rounded-[2rem] shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-y-auto pointer-events-auto relative modal-animate flex flex-col"><div class="sticky top-0 bg-white/95 backdrop-blur px-5 py-4 md:px-8 md:py-5 border-b border-stone-200 flex justify-between items-center z-20"><h3 class="text-lg md:text-xl font-serif font-black text-stone-800">B·∫£n ƒë·ªì Food Tour An Giang</h3><button onclick="closeAllModals()" class="p-2 hover:bg-stone-100 rounded-full transition-colors"><i data-lucide="x"></i></button></div><div class="p-5 md:p-8"><div class="bg-stone-100 w-full h-[400px] md:h-[500px] rounded-2xl relative overflow-hidden group border border-stone-200 shadow-inner"><iframe width="100%" height="100%" frameborder="0" scrolling="no" src="https://maps.google.com/maps?q=10.536294,105.116664&z=10&output=embed" class="opacity-80 hover:opacity-100 transition-opacity duration-500"></iframe></div></div></div></div>
    <!-- 4. Story Modal -->
    <div id="modal-story" class="fixed inset-0 z-[100] flex items-center justify-center p-4 hidden pointer-events-none"><div class="bg-white rounded-2xl md:rounded-[2rem] shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto pointer-events-auto relative modal-animate flex flex-col"><div class="sticky top-0 bg-white/95 backdrop-blur px-5 py-4 md:px-8 md:py-5 border-b border-stone-200 flex justify-between items-center z-20"><h3 class="text-lg md:text-xl font-serif font-black text-stone-800">C√¢u chuy·ªán Di s·∫£n</h3><button onclick="closeAllModals()" class="p-2 hover:bg-stone-100 rounded-full transition-colors"><i data-lucide="x"></i></button></div><div class="p-6 md:p-10 prose prose-lg prose-stone max-w-none font-serif font-medium"><div class="rounded-2xl overflow-hidden shadow-lg mb-6 md:mb-8"><img src="https://product.hstatic.net/1000384853/product/420_2e96288a92d94a31a4d3fd7be5d8eae2.jpg" class="w-full h-48 md:h-72 object-cover hover:scale-105 transition-transform duration-700"></div><h2 class="text-2xl md:text-3xl font-black text-amber-800 mb-4 md:mb-6">30 nƒÉm ƒë·ªè l·ª≠a d∆∞·ªõi ch√¢n n√∫i Sam</h2><p class="lead italic text-stone-600 border-l-4 border-amber-500 pl-4 md:pl-6 py-2 text-base md:text-xl">"B√°nh ngon kh√¥ng ch·ªâ ·ªü b·ªôt, m√† ·ªü c√°i t√¨nh ng∆∞·ªùi l√†m b√°nh g·ª≠i v√†o trong ƒë√≥..."</p><p class="text-sm md:text-base">ƒê√≥ l√† c√¢u chuy·ªán v·ªÅ <strong>D√¨ √öt</strong>, ng∆∞·ªùi ph·ª• n·ªØ ƒë√£ d√†nh h∆°n n·ª≠a ƒë·ªùi ng∆∞·ªùi ƒë·ªÉ gi·ªØ g√¨n h∆∞∆°ng v·ªã b√°nh b√≤ th·ªët n·ªët truy·ªÅn th·ªëng.</p><p class="text-sm md:text-base">S·ª≠ d·ª•ng nh·ªØng nguy√™n li·ªáu "tr·ªùi cho" c·ªßa v√πng B·∫£y N√∫i: b·ªôt g·∫°o n√†ng Nhen, ƒë∆∞·ªùng th·ªët n·ªët nguy√™n ch·∫•t v√† n∆∞·ªõc c·ªët d·ª´a b√©o ng·∫≠y. ƒêi·ªÅu ƒë·∫∑c bi·ªát nh·∫•t ch√≠nh l√† <strong>ng·ªçn l·ª≠a</strong> lu√¥n ƒë·ªè r·ª±c trong b·∫øp l√≤, t∆∞·ª£ng tr∆∞ng cho nhi·ªát huy·∫øt ch∆∞a bao gi·ªù t·∫Øt.</p><div class="bg-amber-50 p-4 md:p-6 rounded-2xl text-sm md:text-base not-italic border border-amber-100 shadow-sm mt-6 md:mt-8"><strong>üìç ƒê·ªãa ƒëi·ªÉm:</strong> D∆∞·ªõi ch√¢n n√∫i Sam, Ch√¢u ƒê·ªëc.<br/><strong>üïí Th√¢m ni√™n:</strong> H∆°n 30 nƒÉm.</div></div></div></div>
    <!-- 5. Add Dish Modal -->
    <div id="modal-add-dish" class="fixed inset-0 z-[100] flex items-center justify-center p-4 hidden pointer-events-none"><div class="bg-white/95 backdrop-blur-2xl rounded-2xl md:rounded-[2rem] shadow-2xl w-full max-w-lg max-h-[90vh] overflow-y-auto pointer-events-auto relative modal-animate flex flex-col border border-white/50"><div class="sticky top-0 bg-white/90 backdrop-blur-md px-6 py-4 border-b border-stone-100 flex justify-between items-center z-20"><h3 class="text-lg md:text-xl font-serif font-black text-stone-800">ƒê·ªÅ c·ª≠ m√≥n ngon</h3><button onclick="closeAllModals()" class="p-2 hover:bg-stone-100 rounded-full transition-colors"><i data-lucide="x"></i></button></div><div class="p-6 md:p-8 font-medium"><form id="add-dish-form" class="space-y-4"><div><label class="block text-sm font-bold text-stone-700 mb-1">T√™n m√≥n ƒÉn</label><input type="text" id="input-name" required class="w-full bg-stone-50 border border-stone-200 rounded-xl px-4 py-3 focus:ring-2 focus:ring-amber-500 outline-none" placeholder="VD: B√°nh m√¨ Long Xuy√™n"></div><div class="grid grid-cols-2 gap-4"><div><label class="block text-sm font-bold text-stone-700 mb-1">Gi√° ti·ªÅn</label><input type="text" id="input-price" required class="w-full bg-stone-50 border border-stone-200 rounded-xl px-4 py-3 focus:ring-2 focus:ring-amber-500 outline-none" placeholder="VD: 15.000ƒë"></div><div><label class="block text-sm font-bold text-stone-700 mb-1">Khu v·ª±c</label><input type="text" id="input-area" required class="w-full bg-stone-50 border border-stone-200 rounded-xl px-4 py-3 focus:ring-2 focus:ring-amber-500 outline-none" placeholder="VD: Ch√¢u ƒê·ªëc"></div></div><div><label class="block text-sm font-bold text-stone-700 mb-1">ƒê·ªãa ch·ªâ qu√°n</label><input type="text" id="input-address" required class="w-full bg-stone-50 border border-stone-200 rounded-xl px-4 py-3 focus:ring-2 focus:ring-amber-500 outline-none" placeholder="ƒê·ªãa ch·ªâ c·ª• th·ªÉ..."></div><div><label class="block text-sm font-bold text-stone-700 mb-1">Link h√¨nh ·∫£nh</label><div class="flex gap-2"><input type="url" id="input-image" required class="w-full bg-stone-50 border border-stone-200 rounded-xl px-4 py-3 focus:ring-2 focus:ring-amber-500 outline-none" placeholder="https://..."><div class="w-12 h-12 rounded-lg border border-stone-200 overflow-hidden bg-stone-100 flex-shrink-0"><img id="image-preview" src="https://placehold.co/100x100?text=Preview" class="w-full h-full object-cover"></div></div><p class="text-xs text-stone-400 mt-1">D√°n link ·∫£nh v√†o ƒë·ªÉ xem tr∆∞·ªõc.</p></div><div><label class="block text-sm font-bold text-stone-700 mb-1">L·ªùi gi·ªõi thi·ªáu</label><textarea id="input-desc" required rows="3" class="w-full bg-stone-50 border border-stone-200 rounded-xl px-4 py-3 focus:ring-2 focus:ring-amber-500 outline-none" placeholder="M√≥n n√†y ngon nh∆∞ th·∫ø n√†o?"></textarea></div><button type="submit" class="w-full bg-amber-600 text-white font-bold py-3.5 rounded-xl hover:bg-amber-700 transition-all shadow-lg hover:shadow-amber-500/30">ƒêƒÉng ngay</button></form></div></div></div>
    <!-- 6. Community Detail Modal -->
    <div id="modal-community-detail" class="fixed inset-0 z-[100] flex items-center justify-center p-4 hidden pointer-events-none"><div class="bg-white/95 backdrop-blur-2xl rounded-2xl md:rounded-[2rem] shadow-2xl w-full max-w-lg max-h-[90vh] overflow-y-auto pointer-events-auto relative modal-animate flex flex-col border border-white/50"><div class="sticky top-0 bg-white/90 backdrop-blur-md px-6 py-4 border-b border-stone-100 flex justify-between items-center z-20"><h3 class="text-lg font-serif font-black text-stone-800">Chi ti·∫øt m√≥n ƒÉn</h3><button onclick="closeAllModals()" class="p-2 hover:bg-stone-100 rounded-full transition-colors"><i data-lucide="x"></i></button></div><div class="p-6"><div class="rounded-xl overflow-hidden h-48 mb-4 shadow-md"><img id="cd-image" class="w-full h-full object-cover"></div><h2 id="cd-name" class="text-2xl font-black text-stone-900 mb-1 font-serif"></h2><p class="text-sm text-stone-500 mb-4 font-medium"><span id="cd-price" class="text-amber-600 font-bold"></span> &bull; <span id="cd-area"></span></p><p id="cd-desc" class="text-stone-700 italic mb-4 text-sm leading-relaxed bg-stone-50 p-3 rounded-lg"></p><p class="text-xs text-stone-400 mb-6 flex items-center"><i data-lucide="map-pin" class="w-3 h-3 mr-1"></i> <span id="cd-address"></span></p><div class="border-t border-stone-100 pt-4"><h4 class="font-bold text-stone-800 mb-3 flex items-center gap-2"><i data-lucide="message-square" class="w-4 h-4"></i> B√¨nh lu·∫≠n ·∫©n danh</h4><div id="comments-list" class="space-y-3 max-h-48 overflow-y-auto mb-4 pr-2"></div><form id="comment-form" class="flex gap-2"><input type="text" id="comment-input" required placeholder="Vi·∫øt b√¨nh lu·∫≠n..." class="flex-1 bg-stone-50 border border-stone-200 rounded-lg px-3 py-2 text-sm focus:ring-1 focus:ring-amber-500 outline-none"><button type="submit" class="bg-amber-600 text-white px-4 py-2 rounded-lg text-sm font-bold hover:bg-amber-700"><i data-lucide="send" class="w-4 h-4"></i></button></form></div></div></div></div>

    <!-- 7. Chat Widget (Button & Window) -->
    <button onclick="toggleChat()" class="fixed bottom-6 right-6 md:bottom-8 md:right-8 z-[80] group">
        <div class="absolute inset-0 bg-amber-500 rounded-full opacity-0 group-hover:animate-pulse-ring"></div>
        <div class="relative bg-gradient-to-br from-amber-600 to-amber-800 text-white p-3 md:p-4 rounded-full shadow-2xl transition-transform transform group-hover:scale-110 group-active:scale-95 border-[3px] border-white/20 backdrop-blur"><i data-lucide="message-circle" class="w-6 h-6 md:w-8 md:h-8"></i></div>
    </button>
    <div id="chat-widget" class="fixed bottom-20 right-4 left-4 md:left-auto md:bottom-28 md:right-8 md:w-96 bg-white/95 md:bg-white/90 backdrop-blur-xl rounded-2xl md:rounded-3xl shadow-2xl z-[80] border border-stone-200/50 hidden flex flex-col h-[60vh] md:h-[550px] modal-animate overflow-hidden font-medium">
        <div class="bg-gradient-to-r from-stone-800 to-stone-900 text-white p-4 md:p-5 flex justify-between items-center relative overflow-hidden">
            <div class="absolute inset-0 bg-noise opacity-10"></div>
            <div class="flex items-center gap-3 md:gap-4 relative z-10"><div class="w-10 h-10 md:w-12 md:h-12 bg-stone-700 rounded-full flex items-center justify-center border-2 border-amber-500 shadow-lg overflow-hidden relative"><img src="https://i.postimg.cc/jjsstjhf/IMG-1744295754904-1744295756131.jpg" alt="Loy" class="w-full h-full object-cover"><span class="absolute bottom-0 right-0 w-2.5 h-2.5 md:w-3 md:h-3 bg-green-500 border-2 border-stone-800 rounded-full"></span></div><div><h3 class="font-bold text-base md:text-lg">Loy</h3><p class="text-[10px] md:text-xs text-stone-300 opacity-80">H·ªçc sinh c·∫•p 3 &bull; Th·ªï ƒë·ªãa An Giang</p></div></div>
            <button onclick="toggleChat()" class="hover:bg-white/10 p-2 rounded-full transition-colors relative z-20"><i data-lucide="x" class="w-5 h-5 md:w-6 md:h-6"></i></button>
        </div>
        <div id="chat-messages" class="flex-1 p-4 md:p-5 overflow-y-auto space-y-4 bg-stone-50/50 scroll-smooth">
            <div class="flex gap-3 animate-fade-in-up"><div class="w-8 h-8 md:w-9 md:h-9 bg-amber-100 rounded-full flex-shrink-0 overflow-hidden border border-amber-200"><img src="https://i.postimg.cc/jjsstjhf/IMG-1744295754904-1744295756131.jpg" class="w-full h-full object-cover"></div><div class="bg-white p-3 md:p-4 rounded-2xl rounded-tl-none shadow-sm border border-stone-100 max-w-[85%] text-xs md:text-sm text-stone-700 leading-relaxed"><p>Ch√†o b·∫°n! M√¨nh l√† <strong>Loy</strong>, h·ªçc sinh c·∫•p 3 t·∫°i An Giang. M√¨nh r·∫•t th√≠ch t√¨m hi·ªÉu v·ªÅ ·∫©m th·ª±c v√† vƒÉn h√≥a qu√™ h∆∞∆°ng. B·∫°n c·∫ßn m√¨nh t∆∞ v·∫•n m√≥n ngon hay ƒë·ªãa ƒëi·ªÉm th√∫ v·ªã n√†o kh√¥ng?</p></div></div>
        </div>
        <div class="p-3 md:p-4 border-t border-stone-100 bg-white/80 backdrop-blur">
            <form onsubmit="handleChatSubmit(event)" class="relative"><input type="text" id="chat-input" placeholder="H·ªèi Loy v·ªÅ m√≥n ƒÉn..." class="w-full bg-stone-100 border-none rounded-full pl-4 md:pl-5 pr-12 md:pr-14 py-3 md:py-4 text-xs md:text-sm focus:ring-2 focus:ring-amber-500/50 outline-none transition-all shadow-inner font-medium text-stone-800 placeholder-stone-400"><button type="submit" class="absolute right-2 top-1.5 md:top-2 p-1.5 md:p-2 bg-amber-600 text-white rounded-full hover:bg-amber-700 transition-colors shadow-md hover:scale-105 active:scale-95 disabled:opacity-50 disabled:scale-100"><i data-lucide="send" class="w-4 h-4 md:w-5 md:h-5"></i></button></form>
        </div>
    </div>

    <!-- FIREBASE LOGIC -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getFirestore, collection, addDoc, onSnapshot, serverTimestamp, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";

        const firebaseConfig = JSON.parse(__firebase_config);
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';

        const initAuth = async () => {
            try {
                if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                    await signInWithCustomToken(auth, __initial_auth_token);
                } else {
                    await signInAnonymously(auth);
                }
            } catch (error) { console.error("Auth Error:", error); }
        };
        initAuth();

        onAuthStateChanged(auth, (user) => {
            if (user) listenForDishes();
        });

        // --- COMMUNITY DISHES ---
        window.communityData = {};

        function listenForDishes() {
            const q = collection(db, 'artifacts', appId, 'public', 'data', 'community_dishes');
            const loading = document.getElementById('community-loading');
            const container = document.getElementById('community-grid');

            onSnapshot(q, (snapshot) => {
                loading.classList.add('hidden');
                const dishes = [];
                snapshot.forEach((doc) => {
                    const data = doc.data();
                    const id = doc.id;
                    dishes.push({ id, ...data });
                    window.communityData[id] = data;
                });
                dishes.sort((a, b) => (b.createdAt?.seconds || 0) - (a.createdAt?.seconds || 0));
                
                if(dishes.length === 0) {
                    container.innerHTML = `<div class="col-span-full text-center text-stone-400 italic py-8">Ch∆∞a c√≥ m√≥n ƒÉn n√†o ƒë∆∞·ª£c ƒë·ªÅ c·ª≠. H√£y l√† ng∆∞·ªùi ƒë·∫ßu ti√™n!</div>`;
                } else {
                    container.innerHTML = dishes.map(item => `
                        <div class="bg-white rounded-2xl shadow-sm border border-stone-100 overflow-hidden hover:shadow-lg transition-all duration-300 group relative cursor-pointer" onclick="window.openCommunityDetail('${item.id}')">
                            <div class="relative h-48 overflow-hidden">
                                <img src="${item.image}" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700" onerror="this.src='https://placehold.co/600x400?text=M√≥n+ngon'">
                                <div class="absolute top-3 left-3 bg-amber-500 text-white px-2 py-1 rounded-lg text-[10px] font-bold uppercase tracking-wider shadow-sm">Th·ª±c kh√°ch ƒë·ªÅ c·ª≠</div>
                                <button onclick="event.stopPropagation(); window.deleteDish('${item.id}')" class="absolute top-3 right-3 bg-white/80 text-red-500 p-1.5 rounded-full hover:bg-red-500 hover:text-white transition-colors z-10 shadow-sm"><i data-lucide="trash-2" class="w-4 h-4"></i></button>
                            </div>
                            <div class="p-4">
                                <h3 class="text-lg font-serif font-bold text-stone-800 mb-1 line-clamp-1">${item.name}</h3>
                                <p class="text-xs text-stone-500 mb-2"><span class="font-bold text-amber-600">${item.price}</span> &bull; ${item.area}</p>
                                <div class="pt-3 border-t border-stone-100 flex items-center text-xs text-stone-400"><i data-lucide="map-pin" class="w-3 h-3 mr-1"></i> <span class="truncate">${item.address}</span></div>
                            </div>
                        </div>`).join('');
                    if(window.lucide) window.lucide.createIcons();
                }
            });
        }

        window.deleteDish = async (id) => {
            if(!confirm("B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a m√≥n n√†y kh√¥ng?")) return;
            try {
                if (!auth.currentUser) await initAuth();
                await deleteDoc(doc(db, 'artifacts', appId, 'public', 'data', 'community_dishes', id));
            } catch (e) { alert("L·ªói x√≥a b√†i: " + e.message); }
        }

        const form = document.getElementById('add-dish-form');
        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            const submitBtn = form.querySelector('button[type="submit"]');
            const originalText = submitBtn.innerText;
            submitBtn.disabled = true; submitBtn.innerText = "ƒêang ƒëƒÉng...";
            try {
                if (!auth.currentUser) await initAuth();
                await addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'community_dishes'), {
                    name: document.getElementById('input-name').value, price: document.getElementById('input-price').value, area: document.getElementById('input-area').value, address: document.getElementById('input-address').value, image: document.getElementById('input-image').value, desc: document.getElementById('input-desc').value, createdAt: serverTimestamp()
                });
                form.reset(); document.getElementById('image-preview').src = 'https://placehold.co/100x100?text=Preview'; window.closeAllModals(); alert("ƒê√£ ƒëƒÉng m√≥n th√†nh c√¥ng!");
            } catch (error) { alert("L·ªói: " + error.message); } finally { submitBtn.disabled = false; submitBtn.innerText = originalText; }
        });

        let unsubscribeComments = null;
        window.currentDishId = null;
        window.openCommunityDetail = (id) => {
            const item = window.communityData[id];
            if (!item) return;
            window.currentDishId = id;
            document.getElementById('cd-name').innerText = item.name; document.getElementById('cd-image').src = item.image; document.getElementById('cd-price').innerText = item.price; document.getElementById('cd-area').innerText = item.area; document.getElementById('cd-address').innerText = item.address; document.getElementById('cd-desc').innerText = `"${item.desc}"`;
            window.openModal('community-detail'); loadComments(id);
        }
        function loadComments(dishId) {
            if(unsubscribeComments) unsubscribeComments();
            const q = collection(db, 'artifacts', appId, 'public', 'data', 'community_dishes', dishId, 'comments');
            unsubscribeComments = onSnapshot(q, (snapshot) => {
                const comments = []; snapshot.forEach((doc) => comments.push({ id: doc.id, ...doc.data() }));
                comments.sort((a, b) => (b.createdAt?.seconds || 0) - (a.createdAt?.seconds || 0));
                const list = document.getElementById('comments-list');
                if(comments.length === 0) { list.innerHTML = '<p class="text-xs text-stone-400 italic text-center py-2">Ch∆∞a c√≥ b√¨nh lu·∫≠n n√†o.</p>'; } else { list.innerHTML = comments.map(c => `<div class="bg-stone-50 p-3 rounded-xl border border-stone-100"><p class="text-[10px] font-bold text-amber-700 mb-1 uppercase tracking-wider">Ng∆∞·ªùi l·∫° ∆°i</p><p class="text-sm text-stone-700 font-medium">${c.text}</p></div>`).join(''); }
            });
        }
        document.getElementById('comment-form').addEventListener('submit', async (e) => { e.preventDefault(); const text = document.getElementById('comment-input').value; if(!text.trim() || !window.currentDishId) return; try { if (!auth.currentUser) await initAuth(); await addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'community_dishes', window.currentDishId, 'comments'), { text: text, createdAt: serverTimestamp() }); document.getElementById('comment-input').value = ''; } catch(e) { alert("L·ªói b√¨nh lu·∫≠n: " + e.message); } });
        document.getElementById('input-image').addEventListener('input', (e) => { document.getElementById('image-preview').src = e.target.value || 'https://placehold.co/100x100?text=Preview'; });
    </script>

    <!-- APP LOGIC -->
    <script>
        document.addEventListener('DOMContentLoaded', () => { AOS.init({ once: true, offset: 50, duration: 800 }); renderFilterButtons(); renderProducts(); lucide.createIcons(); });
        const reviews = [ { id: 1, name: "B√∫n C√° Ch√¢u ƒê·ªëc", category: "an-sang", image: "https://mia.vn/media/uploads/blog-du-lich/bun-ca-chau-doc-dac-san-tru-danh-cua-dat-an-giang-01-1659942632.jpg", address: "Ch·ª£ Ch√¢u ƒê·ªëc, P. Ch√¢u Ph√∫ A", price: "25.000ƒë", rating: 5, tags: ["#MustTry", "#DamDa"], desc: "N∆∞·ªõc l√®o v√†ng ngh·ªá, th∆°m m√πi ng√£i b√∫n.", origin: "An Giang / Khmer", taste: "Ngh·ªá, s·∫£, ng·∫£i b√∫n, m·∫Øm ru·ªëc.", history: "Giao thoa vƒÉn h√≥a Kinh - Khmer.", descLong: "B√∫n c√° Ch√¢u ƒê·ªëc c√≥ ngu·ªìn g·ªëc xu·∫•t ph√°t t·ª´ v√πng ƒë·ªìng b·∫±ng s√¥ng C·ª≠u Long...", coords: { lat: 10.708688, lng: 105.114755 } }, { id: 4, name: "C∆°m T·∫•m Long Xuy√™n", category: "no-bung", image: "https://mia.vn/media/uploads/blog-du-lich/com-tam-long-xuyen-mon-an-don-gian-nhung-day-cuon-hut-01-1660584910.jpg", address: "C√¢y ƒêi·ªáp, Long Xuy√™n", price: "35.000ƒë", rating: 4, tags: ["#AnTrua", "#GiaTruyen"], desc: "H·∫°t t·∫•m nhuy·ªÖn, th·ªãt kh√¨a c·∫Øt nh·ªè.", origin: "Long Xuy√™n, An Giang", taste: "Th∆°m, b√πi, n∆∞·ªõc m·∫Øm chua ng·ªçt.", history: "T·∫≠n d·ª•ng h·∫°t g·∫°o v·ª° sau xay x√°t.", descLong: "C∆°m t·∫•m Long Xuy√™n n·ªïi ti·∫øng v·ªõi h·∫°t t·∫•m nhuy·ªÖn, kh√°c bi·ªát so v·ªõi S√†i G√≤n...", coords: { lat: 10.371836, lng: 105.438290 } }, { id: 5, name: "B√°nh Canh Vƒ©nh Trung", category: "an-sang", image: "https://static.vinwonders.com/production/2025/11/banh-canh-vinh-trung-ut-viet.jpg", address: "X√£ Vƒ©nh Trung, T·ªãnh Bi√™n", price: "30.000ƒë", rating: 4.5, tags: ["#DaiNgon", "#LaMieng"], desc: "S·ª£i b√°nh canh d·∫πt, dai l·∫° mi·ªáng.", origin: "L√†ng ngh·ªÅ Vƒ©nh Trung, T·ªãnh Bi√™n.", taste: "S·ª£i b√°nh dai s·∫ßn s·∫≠t, n∆∞·ªõc l√®o ng·ªçt.", history: "ƒê·∫∑c s·∫£n v√πng B·∫£y N√∫i.", descLong: "B√°nh canh Vƒ©nh Trung n·ªïi ti·∫øng nh·ªù s·ª£i b√°nh l√†m t·ª´ g·∫°o Neang Nhen...", coords: { lat: 10.5186, lng: 105.0039 } }, { id: 2, name: "G√† ƒê·ªët √î Thum", category: "lai-rai", image: "https://mia.vn/media/uploads/blog-du-lich/ga-dot-o-thum-dac-san-nuc-tieng-tai-vung-dat-tri-ton-tinh-an-giang-05-1660497843.jpeg", address: "H·ªì √î Thum, Tri T√¥n", price: "250k/con", rating: 5, tags: ["#DacSan", "#ViewHo"], desc: "G√† th·∫£ v∆∞·ªùn ƒë·ªët l√° ch√∫c th∆°m l·ª´ng.", origin: "Khmer v√πng B·∫£y N√∫i", taste: "Da gi√≤n, th·ªãt ng·ªçt, th∆°m l√° ch√∫c.", history: "M√≥n ƒÉn c·ªßa c·ªông ƒë·ªìng Khmer.", descLong: "G√† ƒë·ªët √¥ thum c√≥ ngu·ªìn g·ªëc c·ªßa ƒë·∫∑c s·∫£n g√† ƒë·ªët √î Thum...", coords: { lat: 10.395782, lng: 105.003185 } }, { id: 6, name: "L·∫©u M·∫Øm Ch√¢u ƒê·ªëc", category: "lai-rai", image: "https://static.vinwonders.com/production/2025/10/lau-mam-chau-doc-topbanner.jpg", address: "Qu√°n ƒê·ªìng Qu√™, Ch√¢u ƒê·ªëc", price: "200.000ƒë", rating: 5, tags: ["#DamDa", "#RauSong"], desc: "H∆∞∆°ng v·ªã m·∫Øm c√° linh ƒë·∫≠m ƒë√†.", origin: "Campuchia / Mi·ªÅn T√¢y", taste: "M·∫Øm truy·ªÅn th·ªëng, rau, h·∫£i s·∫£n.", history: "Giao thoa ·∫©m th·ª±c.", descLong: "L·∫©u m·∫Øm Ch√¢u ƒê·ªëc c√≥ ngu·ªìn g·ªëc t·ª´ Campuchia...", coords: { lat: 10.7025, lng: 105.1118 } }, { id: 3, name: "B√°nh B√≤ Th·ªët N·ªët", category: "ngot-ngao", image: "https://tiembanhkimnhu.com/wp-content/uploads/2022/01/banh-bo-thot-not.jpg", address: "Ch√¢n n√∫i Sam, Ch√¢u ƒê·ªëc", price: "5.000ƒë", rating: 4.5, tags: ["#AnVat", "#QuaQue"], desc: "V·ªã ng·ªçt thanh c·ªßa ƒë∆∞·ªùng th·ªët n·ªët x·ªãn.", origin: "B·∫£y N√∫i - An Giang", taste: "Ng·ªçt thanh, th∆°m th·ªët n·ªët.", history: "·∫®m th·ª±c Khmer Nam B·ªô.", descLong: "B√°nh b√≤ th·ªët n·ªët c√≥ ngu·ªìn g·ªëc t·ª´ v√πng B·∫£y N√∫i...", coords: { lat: 10.695328, lng: 105.076239 } }, { id: 7, name: "Ch√® B∆∞·ªüi An Giang", category: "ngot-ngao", image: "https://cdn.tgdd.vn/2020/08/CookProduct/Untitled-2-1200x676-11.jpg", address: "Ch·ª£ Long Xuy√™n", price: "15.000ƒë", rating: 4, tags: ["#MatLanh", "#BeoNgay"], desc: "C√πi b∆∞·ªüi gi√≤n s·∫ßn s·∫≠t, ƒë·∫≠u xanh b√πi.", origin: "Mi·ªÅn T√¢y / An Giang", taste: "Thanh m√°t, b√©o ng·∫≠y.", history: "T·∫≠n d·ª•ng v·ªè b∆∞·ªüi ƒë·ªãa ph∆∞∆°ng.", descLong: "Ch√® b∆∞·ªüi An Giang c√≥ ngu·ªìn g·ªëc t·ª´ v√πng mi·ªÅn T√¢y...", coords: { lat: 10.3759, lng: 105.4328 } }, { id: 8, name: "M·∫Øm Th√°i Ch√¢u ƒê·ªëc", category: "qua-que", image: "https://img.lazcdn.com/g/p/3af398857c380f013dfe3638842cd50b.jpg_720x720q80.jpg", address: "Ch·ª£ M·∫Øm Ch√¢u ƒê·ªëc", price: "150k/kg", rating: 5, tags: ["#DacSan", "#BaoQuanLau"], desc: "Th∆∞∆°ng hi·ªáu m·∫Øm B√† Gi√°o Kh·ªèe l·ª´ng danh.", origin: "L√†ng ngh·ªÅ m·∫Øm Ch√¢u ƒê·ªëc", taste: "M·∫∑n m√≤i, th∆°m n·ªìng.", history: "L√¢u ƒë·ªùi, ·∫£nh h∆∞·ªüng Khmer.", descLong: "M·∫Øm th√°i Ch√¢u ƒê·ªëc c√≥ ngu·ªìn g·ªëc t·ª´ An Giang...", coords: { lat: 10.7092, lng: 105.1158 } }, { id: 9, name: "Tung L√≤ M√≤", category: "qua-que", image: "https://cdn3.ivivu.com/2022/12/tung-lo-mo-ivivu.jpg", address: "L√†ng ChƒÉm Ch√¢u Phong", price: "280k/kg", rating: 4.5, tags: ["#DocLa", "#Halal"], desc: "ƒê·∫∑c s·∫£n b√≤ n∆∞·ªõng c·ªßa ng∆∞·ªùi ChƒÉm.", origin: "ƒê·ªìng b√†o ChƒÉm An Giang", taste: "Th·ªãt b√≤ v√† gia v·ªã ƒë·∫∑c tr∆∞ng.", history: "M√≥n truy·ªÅn th·ªëng ChƒÉm H·ªìi gi√°o.", descLong: "Tung l√≤ m√≤ (l·∫°p x∆∞·ªüng b√≤) c√≥ ngu·ªìn g·ªëc t·ª´ ƒë·ªìng b√†o ChƒÉm...", coords: { lat: 10.6833, lng: 105.0833 } } ];
        let activeMood = 'all';
        function renderFilterButtons() { const moods = [ { id: 'doi', icon: 'utensils', text: 'ƒê√≥i c·ªìn c√†o' }, { id: 'lairai', icon: 'coffee', text: 'Lai rai t√¢m t√¨nh' }, { id: 'ngot', icon: 'star', text: 'H·∫£o ng·ªçt' }, { id: 'qua', icon: 'shopping-bag', text: 'Mua l√†m qu√†' } ]; document.getElementById('filter-buttons').innerHTML = moods.map(m => `<button onclick="setMood('${m.id}')" class="flex items-center gap-2 px-4 md:px-6 py-2.5 md:py-3 rounded-full transition-all duration-300 transform hover:scale-105 border text-sm md:text-base font-medium ${activeMood === m.id ? 'bg-amber-500 text-stone-900 font-bold border-amber-500 shadow-lg scale-105' : 'bg-stone-800 hover:bg-stone-700 border-stone-700'}"><i data-lucide="${m.icon}" class="w-3.5 h-3.5 md:w-4 md:h-4"></i> ${m.text}</button>`).join(''); }
        function setMood(mood) { activeMood = activeMood === mood ? 'all' : mood; renderFilterButtons(); renderProducts(); lucide.createIcons(); }
        function renderProducts() { const container = document.getElementById('product-grid'); const filtered = activeMood === 'all' ? reviews : reviews.filter(item => { if (activeMood === 'doi') return ['an-sang', 'no-bung'].includes(item.category); if (activeMood === 'lairai') return ['lai-rai'].includes(item.category); if (activeMood === 'ngot') return ['ngot-ngao'].includes(item.category); if (activeMood === 'qua') return ['qua-que'].includes(item.category); return true; }); container.innerHTML = filtered.map((item, index) => `<div onclick="openProductDetail(${item.id})" data-aos="fade-up" data-aos-delay="${index * 50}" class="bg-white rounded-[2rem] shadow-sm border border-stone-100 overflow-hidden hover:shadow-2xl transition-all duration-300 cursor-pointer group hover:-translate-y-2"><div class="relative h-48 md:h-56 overflow-hidden"><img src="${item.image}" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700" onerror="this.src='https://placehold.co/600x400?text=Mon+Ngon'"><div class="absolute top-3 right-3 bg-white/90 backdrop-blur-sm px-3 py-1 rounded-full text-[10px] md:text-xs font-bold shadow-sm text-stone-800">${item.price}</div><button onclick="event.stopPropagation(); handleGetDirections(${item.id})" class="absolute bottom-3 right-3 bg-amber-500 text-white p-2 md:p-2.5 rounded-full shadow-lg opacity-0 group-hover:opacity-100 hover:bg-amber-600 transition-all transform translate-y-4 group-hover:translate-y-0 duration-300"><i data-lucide="navigation" class="w-4 h-4"></i></button></div><div class="p-5 md:p-6"><div class="flex gap-2 mb-3 flex-wrap">${item.tags.map(t => `<span class="text-[10px] font-bold uppercase tracking-wide bg-stone-100 text-stone-600 px-2 md:px-3 py-1 md:py-1.5 rounded-lg border border-stone-200">${t}</span>`).join('')}</div><h3 class="text-lg md:text-xl font-serif font-bold text-stone-800 mb-2 leading-tight group-hover:text-amber-700 transition-colors">${item.name}</h3><p class="text-xs text-stone-500 line-clamp-2 mb-4 h-8 leading-relaxed font-medium">${item.desc}</p><div class="flex items-center justify-between mt-4 pt-4 border-t border-stone-100"><div class="flex text-amber-500 gap-0.5 text-xs md:text-sm">${'‚úø'.repeat(Math.floor(item.rating))}</div><div class="flex items-center text-[10px] md:text-xs text-stone-400 truncate ml-2 font-medium"><i data-lucide="map-pin" class="w-3 h-3 mr-1"></i> <span class="truncate max-w-[100px]">${item.address}</span></div></div></div></div>`).join(''); }

        // Window exposed functions
        window.openModal = (type) => { document.getElementById('modal-overlay').classList.remove('hidden'); document.getElementById(`modal-${type}`).classList.remove('hidden'); document.body.style.overflow = 'hidden'; }
        window.closeAllModals = () => { document.getElementById('modal-overlay').classList.add('hidden'); document.querySelectorAll('[id^="modal-"]').forEach(el => { if(el.id !== 'modal-overlay') el.classList.add('hidden'); }); document.body.style.overflow = 'auto'; }
        window.toggleMobileMenu = () => { document.getElementById('mobile-menu').classList.toggle('hidden'); }
        window.scrollToSection = (id) => { const el = document.getElementById(id); if(el) el.scrollIntoView({ behavior: 'smooth' }); }
        window.filterByFooter = (mood) => { setMood(mood); scrollToSection('section-reviews'); }
        window.openProductDetail = (id) => { const product = reviews.find(r => r.id === id); if(!product) return; document.getElementById('mp-title').innerText = product.name; document.getElementById('mp-image').src = product.image; document.getElementById('mp-origin').innerText = product.origin; document.getElementById('mp-taste').innerText = product.taste; document.getElementById('mp-history').innerText = product.history; document.getElementById('mp-address').innerText = product.address; document.getElementById('mp-price').innerText = product.price; document.getElementById('mp-desc-long').innerText = product.descLong; document.getElementById('mp-tags').innerHTML = product.tags.map(t => `<span class="text-xs font-bold uppercase tracking-wide bg-amber-100 text-amber-800 px-3 py-1 rounded-full">${t}</span>`).join(''); const btn = document.getElementById('btn-directions'); btn.onclick = () => { window.closeAllModals(); window.handleGetDirections(product.id); }; window.openModal('product'); }
        window.handleGetDirections = (id) => { const product = reviews.find(r => r.id === id); if(!product) return; window.openModal('map'); document.getElementById('map-title').innerText = `ƒê∆∞·ªùng ƒë·∫øn: ${product.name}`; document.getElementById('map-iframe').src = `https://maps.google.com/maps?q=${product.coords.lat},${product.coords.lng}&z=15&output=embed`; const statusDiv = document.getElementById('map-status'); statusDiv.innerHTML = '<span class="text-amber-600 animate-pulse font-medium">ƒêang ƒë·ªãnh v·ªã v·ªá tinh...</span>'; if (!navigator.geolocation) { statusDiv.innerHTML = '<span class="text-red-500 font-medium">Tr√¨nh duy·ªát kh√¥ng h·ªó tr·ª£ GPS.</span>'; return; } navigator.geolocation.getCurrentPosition((position) => { statusDiv.innerHTML = `<div class="text-sm text-blue-800 font-medium"><p>üìç V·ªã tr√≠ c·ªßa b·∫°n: <span class="font-bold text-green-600">ƒê√£ x√°c ƒë·ªãnh</span></p></div>`; document.getElementById('btn-google-maps').href = `https://www.google.com/maps/dir/?api=1&origin=${position.coords.latitude},${position.coords.longitude}&destination=${product.coords.lat},${product.coords.lng}`; }, (e) => { console.error(e); statusDiv.innerHTML = '<span class="text-red-500 font-medium">Kh√¥ng th·ªÉ l·∫•y v·ªã tr√≠.</span>'; document.getElementById('btn-google-maps').href = `https://www.google.com/maps/dir/?api=1&destination=${product.coords.lat},${product.coords.lng}`; }); }
        
        const GEMINI_API_KEY = "AIzaSyDWq0s5crn5nByL4ZVnsjjfnUYC5D-WyEU";
        window.toggleChat = () => document.getElementById('chat-widget').classList.toggle('hidden');
        window.handleChatSubmit = async (e) => { e.preventDefault(); const input = document.getElementById('chat-input'); const message = input.value.trim(); if (!message) return; addMessage(message, 'user'); input.value = ''; const loadingId = addLoading(); try { const reply = await callGeminiAPI(message); removeMessage(loadingId); addMessage(reply, 'ai'); } catch (error) { removeMessage(loadingId); addMessage("M·∫°ng ƒëang h∆°i ch·∫≠p ch·ªùn, b·∫°n ƒë·ª£i x√≠u r·ªìi h·ªèi l·∫°i m√¨nh nha!", 'ai'); } };
        function addMessage(text, sender) { const c = document.getElementById('chat-messages'); const d = document.createElement('div'); const isAI = sender === 'ai'; d.className = `flex gap-3 ${isAI ? '' : 'flex-row-reverse'} animate-fade-in-up`; const avatarUrl = isAI ? 'https://i.postimg.cc/jjsstjhf/IMG-1744295754904-1744295756131.jpg' : 'https://api.dicebear.com/7.x/avataaars/svg?seed=Khach&backgroundColor=e6e6e6'; d.innerHTML = `<div class="w-8 h-8 md:w-10 md:h-10 ${isAI ? 'bg-stone-700' : 'bg-stone-300'} rounded-full flex-shrink-0 overflow-hidden border-2 border-white shadow-md"><img src="${avatarUrl}" class="w-full h-full object-cover"></div><div class="${isAI ? 'bg-white text-stone-800' : 'bg-amber-600 text-white'} p-3 md:p-3.5 rounded-2xl ${isAI ? 'rounded-tl-none' : 'rounded-tr-none'} shadow-md max-w-[85%] text-xs md:text-sm leading-relaxed prose-sm font-medium">${isAI ? marked.parse(text) : text}</div>`; c.appendChild(d); c.scrollTop = c.scrollHeight; }
        function addLoading() { const id='l-'+Date.now(); const c=document.getElementById('chat-messages'); const d=document.createElement('div'); d.id=id; d.className="flex gap-3 animate-fade-in-up"; d.innerHTML=`<div class="w-8 h-8 md:w-10 md:h-10 bg-stone-700 rounded-full border-2 border-white shadow-md"><img src="https://i.postimg.cc/jjsstjhf/IMG-1744295754904-1744295756131.jpg" class="w-full h-full object-cover"></div><div class="bg-white p-4 rounded-2xl rounded-tl-none shadow-md flex gap-1 h-12 items-center"><div class="w-1.5 h-1.5 bg-stone-400 rounded-full typing-dot"></div><div class="w-1.5 h-1.5 bg-stone-400 rounded-full typing-dot"></div><div class="w-1.5 h-1.5 bg-stone-400 rounded-full typing-dot"></div></div>`; c.appendChild(d); c.scrollTop=c.scrollHeight; return id; }
        function removeMessage(id) { const el=document.getElementById(id); if(el) el.remove(); }
        const delay = ms => new Promise(r => setTimeout(r, ms));
        async function callGeminiAPI(userMsg) { const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${GEMINI_API_KEY}`; const contextData = reviews.map(r => `${r.name}: ${r.descLong} (T·∫°i: ${r.address})`).join("\n"); const finalPrompt = `B·∫°n l√† Loy, h·ªçc sinh c·∫•p 3 am hi·ªÉu ·∫©m th·ª±c An Giang. T∆∞ v·∫•n ng·∫Øn g·ªçn, th√¢n thi·ªán, x∆∞ng M√¨nh-B·∫°n. D·ªØ li·ªáu: ${contextData}. Kh√°ch h·ªèi: "${userMsg}"`; const payload = { contents: [{ parts: [{ text: finalPrompt }] }] }; let attempt = 0; while (attempt < 3) { try { const res = await fetch(url, { method: "POST", headers: { "Content-Type": "application/json" }, body: JSON.stringify(payload) }); if (res.status === 503 || res.status === 429) { attempt++; await delay(1000 * Math.pow(2, attempt)); continue; } if (!res.ok) throw new Error("API Error"); const data = await res.json(); return data.candidates[0].content.parts[0].text; } catch (e) { attempt++; await delay(1000); } } throw new Error("Failed"); }
    </script>
</body>
</html>
